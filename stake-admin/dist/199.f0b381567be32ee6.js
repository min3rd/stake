"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[199],{48199:(me,w,o)=>{o.r(w),o.d(w,{UserModule:()=>x});var p=o(36895),u=o(89299),e=o(94650);class b{}b.\u0275fac=function(t){return new(t||b)},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-user"]],decls:1,vars:0,template:function(t,r){1&t&&e._UZ(0,"router-outlet")},dependencies:[u.lC]});var c=o(24006),I=o(77579),y=o(82722),U=o(63900),Y=o(94880),J=o(61135),A=o(95698),C=o(18505),B=o(80529),R=o(65240);class l{constructor(t,r){this._httpClient=t,this._apiService=r,this._users=new J.X([]),this._user=new J.X(null)}get users$(){return this._users.asObservable()}get user$(){return this._user.asObservable()}searchUsers(t="",r=0,s=10){return this._users.pipe((0,A.q)(1),(0,U.w)(i=>this._httpClient.get(this._apiService.admin_users(t,r,s)).pipe((0,C.b)(a=>{this._users.next(a)}))))}getUserById(t){return this._users.pipe((0,A.q)(1),(0,U.w)(r=>this._httpClient.get(this._apiService.admin_users_user(t)).pipe((0,C.b)(s=>{let i=r.findIndex(a=>a.id==s.id);i>=0?r[i]=s:r.push(s),this._users.next(r),this._user.next(s)}))))}updateUser(t){return this._users.pipe((0,A.q)(1),(0,U.w)(r=>this._httpClient.patch(this._apiService.admin_users_user(t.id),t).pipe((0,C.b)(s=>{let i=r.findIndex(a=>a.id==s.id);i>=0?r[i]=s:r.push(s),this._users.next(r),this._user.next(s)}))))}}l.\u0275fac=function(t){return new(t||l)(e.LFG(B.eN),e.LFG(R.s))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"});var d=o(59549),L=o(97392),k=o(284),_=o(23267),D=o(63317),Q=o(85707);const N=["matDrawer"];function M(n,t){if(1&n&&(e.ynx(0),e.TgZ(1,"div",24),e._uU(2),e.qZA(),e.BQk()),2&n){const r=e.oxw().$implicit;e.xp6(2),e.hij(" ",r.name.charAt(0)," ")}}function O(n,t){if(1&n&&(e.ynx(0),e._UZ(1,"img",25),e.BQk()),2&n){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("src",r.avatar,e.LSH)}}function G(n,t){if(1&n&&(e.ynx(0),e.TgZ(1,"div",26),e._uU(2),e.qZA(),e.BQk()),2&n){const r=e.oxw().$implicit;e.xp6(2),e.hij(" ",r.name.charAt(0)," ")}}const $=function(n,t){return{"hover:bg-gray-100 dark:hover:bg-hover":n,"bg-primary-50 dark:bg-hover":t}},H=function(n){return["./",n]};function E(n,t){if(1&n&&(e.ynx(0),e.YNc(1,M,3,1,"ng-container",13),e.TgZ(2,"a",17)(3,"div",18),e.YNc(4,O,2,1,"ng-container",13),e.YNc(5,G,3,1,"ng-container",13),e.qZA(),e.TgZ(6,"div",19)(7,"div",20)(8,"span",21),e._uU(9),e.qZA(),e.TgZ(10,"span",22),e._uU(11),e.qZA()(),e.TgZ(12,"div",23),e._uU(13),e.qZA()()(),e.BQk()),2&n){const r=t.$implicit,s=t.index,i=e.oxw(2).ngIf,a=e.oxw();e.xp6(1),e.Q6J("ngIf",0===s||r.name.charAt(0)!==i[s-1].name.charAt(0)),e.xp6(1),e.Q6J("ngClass",e.WLB(8,$,!a.selectedUser||a.selectedUser.id!==r.id,a.selectedUser&&a.selectedUser.id===r.id))("routerLink",e.VKq(11,H,r.id)),e.xp6(2),e.Q6J("ngIf",r.avatar),e.xp6(1),e.Q6J("ngIf",!r.avatar),e.xp6(4),e.hij(" ",r.name," "),e.xp6(2),e.hij(" (",r.username,") "),e.xp6(2),e.Oqu(r.phone)}}function V(n,t){if(1&n&&(e.ynx(0),e.YNc(1,E,14,13,"ng-container",16),e.BQk()),2&n){const r=e.oxw().ngIf,s=e.oxw();e.xp6(1),e.Q6J("ngForOf",r)("ngForTrackBy",s.trackByFn)}}function K(n,t){if(1&n&&(e.ynx(0),e.YNc(1,V,2,2,"ng-container",15),e.BQk()),2&n){const r=t.ngIf;e.oxw();const s=e.MAs(24);e.xp6(1),e.Q6J("ngIf",r.length)("ngIfElse",s)}}function W(n,t){1&n&&(e.TgZ(0,"div",27),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"transloco"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"there are no users"))," "))}class m{constructor(t,r,s,i,a,de){this._activatedRoute=t,this._changeDetectorRef=r,this._document=s,this._router=i,this._fuseMediaWatcherService=a,this._userService=de,this.searchInputControl=new c.p4,this._unsubscribeAll=new I.x}ngOnInit(){this.users$=this._userService.users$,this._userService.user$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedUser=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,y.R)(this._unsubscribeAll),(0,U.w)(t=>this._userService.searchUsers(t))).subscribe(),this.matDrawer.openedChange.subscribe(t=>{t||(this.selectedUser=null,this._changeDetectorRef.markForCheck())}),this._fuseMediaWatcherService.onMediaChange$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(({matchingAliases:t})=>{this.drawerMode=t.includes("lg")?"side":"over",this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}trackByFn(t,r){return r.id||t}}m.\u0275fac=function(t){return new(t||m)(e.Y36(u.gz),e.Y36(e.sBO),e.Y36(p.K0),e.Y36(u.F0),e.Y36(Y.T),e.Y36(l))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-user-list"]],viewQuery:function(t,r){if(1&t&&e.Gf(N,7),2&t){let s;e.iGM(s=e.CRH())&&(r.matDrawer=s.first)}},decls:25,vars:20,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","md:w-160","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex-auto"],[1,"flex","flex-col","sm:flex-row","md:flex-col","flex-auto","justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"flex","items-center","mt-4","sm:mt-0","md:mt-4"],["subscriptSizing","dynamic",1,"fuse-mat-dense","fuse-mat-rounded","w-full","min-w-50"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"relative"],[4,"ngIf"],["noUsers",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","px-6","py-4","md:px-8","cursor-pointer","border-b",3,"ngClass","routerLink"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","ml-4"],[1,"flex","gap-2","items-center"],[1,"font-medium","leading-5","truncate"],[1,"text-secondary","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"z-10","sticky","top-0","-mt-px","px-6","py-1","md:px-8","border-t","border-b","font-medium","uppercase","text-secondary","bg-gray-50","dark:bg-gray-900"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"mat-drawer-container",1),e.NdJ("backdropClick",function(){return r.onBackdropClicked()}),e.TgZ(2,"mat-drawer",2,3),e._UZ(4,"router-outlet"),e.qZA(),e.TgZ(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),e._uU(10),e.ALo(11,"capitalize"),e.ALo(12,"transloco"),e.qZA()(),e.TgZ(13,"div",8)(14,"div",5)(15,"mat-form-field",9),e._UZ(16,"mat-icon",10)(17,"input",11),e.ALo(18,"capitalize"),e.ALo(19,"transloco"),e.qZA()()()(),e.TgZ(20,"div",12),e.YNc(21,K,2,2,"ng-container",13),e.ALo(22,"async"),e.YNc(23,W,4,5,"ng-template",null,14,e.W1O),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("mode",r.drawerMode)("opened",!1)("position","end")("disableClose",!0),e.xp6(8),e.Oqu(e.lcZ(11,10,e.lcZ(12,12,"users"))),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",r.searchInputControl)("autocomplete","off")("placeholder",e.lcZ(18,14,e.lcZ(19,16,"search users"))),e.xp6(4),e.Q6J("ngIf",e.lcZ(22,18,r.users$)))},dependencies:[p.mk,p.sg,p.O5,u.lC,u.rH,d.KE,d.qo,L.Hw,k.Nt,_.jA,_.kh,_.LW,c.Fj,c.JJ,c.oH,p.Ov,D.e,Q.Ot],encapsulation:2,changeDetection:0});var T=o(4859),F=o(56709),z=o(10266);function X(n,t){if(1&n&&e._UZ(0,"img",24),2&n){const r=e.oxw();e.Q6J("src",r.user.avatar,e.LSH)}}function q(n,t){if(1&n&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&n){const r=e.oxw();e.xp6(1),e.hij(" ",r.user.name.charAt(0)," ")}}function P(n,t){if(1&n){const r=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.blockUser())}),e.ALo(1,"capitalize"),e.ALo(2,"transloco"),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"transloco"),e.qZA()}2&n&&(e.Q6J("color","warn")("matTooltip",e.lcZ(1,3,e.lcZ(2,5,"block"))),e.xp6(3),e.hij(" ",e.lcZ(4,7,e.lcZ(5,9,"block"))," "))}function ee(n,t){if(1&n){const r=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.unblockUser())}),e.ALo(1,"capitalize"),e.ALo(2,"transloco"),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"transloco"),e.qZA()}2&n&&(e.Q6J("color","warn")("matTooltip",e.lcZ(1,3,e.lcZ(2,5,"unblock"))),e.xp6(3),e.hij(" ",e.lcZ(4,7,e.lcZ(5,9,"unblock"))," "))}const S=function(){return["../"]};class Z{constructor(t,r,s,i){this._changeDetectorRef=t,this._userListComponent=r,this._formBuilder=s,this._userService=i,this._unsubscribeAll=new I.x}ngOnInit(){this._userListComponent.matDrawer.open(),this.userForm=this._formBuilder.group({id:[""],cash:[0],demoCash:[0],blocked:[!1]}),this._userService.user$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this.userForm.patchValue(t),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDrawer(){return this._userListComponent.matDrawer.close()}trackByFn(t,r){return r.id||t}updateUser(){const t=this.userForm.getRawValue();this._userService.updateUser(t).subscribe()}blockUser(){this.user.blocked=!0,this._userService.updateUser(this.user).subscribe()}unblockUser(){this.user.blocked=!1,this._userService.updateUser(this.user).subscribe()}}Z.\u0275fac=function(t){return new(t||Z)(e.Y36(e.sBO),e.Y36(m),e.Y36(c.QS),e.Y36(l))},Z.\u0275cmp=e.Xpm({type:Z,selectors:[["app-user-detail"]],decls:59,vars:71,consts:[[1,"flex","flex-col","w-full"],[1,"relative","w-full","h-40","sm:h-48","px-8","sm:px-12","bg-accent-100","dark:bg-accent-700"],[1,"flex","items-center","justify-end","w-full","max-w-3xl","mx-auto","pt-6"],["mat-icon-button","",3,"matTooltip","routerLink"],[1,"text-white",3,"svgIcon"],[1,"relative","flex","flex-col","flex-auto","items-center","px-6","sm:px-12"],[1,"w-full","max-w-3xl"],[3,"formGroup"],[1,"flex","flex-auto","-mt-16","gap-6","items-baseline"],[1,"relative","flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["class","flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200",4,"ngIf"],[1,"mt-8"],[1,"text-secondary"],["type","hidden",3,"formControlName"],[1,"fuse-mat-dense","fuse-mat-rounded","w-full",3,"subscriptSizing"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","type","number",3,"formControlName","placeholder","spellcheck"],[1,"mt-8","flex","flex-auto","items-center","gap-6"],["disabled","",1,"example-margin",3,"checked"],[1,"flex","items-center","mt-10","-mx-6","sm:-mx-12","py-4","pr-4","pl-1","sm:pr-12","sm:pl-7","border-t","bg-gray-50","dark:bg-transparent"],["mat-button","",3,"color","matTooltip","click",4,"ngIf"],["mat-button","",1,"ml-auto",3,"matTooltip","routerLink"],["mat-flat-button","",1,"ml-2",3,"color","disabled","matTooltip","click"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded","overflow-hidden","uppercase","text-8xl","font-bold","leading-none","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],["mat-button","",3,"color","matTooltip","click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),e._UZ(4,"mat-icon",4),e.qZA()()(),e.TgZ(5,"div",5)(6,"div",6)(7,"form",7)(8,"div",8)(9,"div",9),e.YNc(10,X,1,1,"img",10),e.YNc(11,q,2,1,"div",11),e.qZA(),e.TgZ(12,"div",12)(13,"div"),e._uU(14),e.qZA(),e.TgZ(15,"div",13),e._uU(16),e.qZA()()(),e._UZ(17,"input",14),e.TgZ(18,"div",12)(19,"mat-form-field",15)(20,"mat-label"),e._uU(21),e.ALo(22,"capitalize"),e.ALo(23,"transloco"),e.qZA(),e._UZ(24,"mat-icon",16)(25,"input",17),e.ALo(26,"capitalize"),e.ALo(27,"transloco"),e.qZA()(),e.TgZ(28,"div",12)(29,"mat-form-field",15)(30,"mat-label"),e._uU(31),e.ALo(32,"capitalize"),e.ALo(33,"transloco"),e.qZA(),e._UZ(34,"mat-icon",16)(35,"input",17),e.ALo(36,"capitalize"),e.ALo(37,"transloco"),e.qZA()(),e.TgZ(38,"div",18)(39,"mat-label"),e._uU(40),e.ALo(41,"capitalize"),e.ALo(42,"transloco"),e.qZA(),e._UZ(43,"mat-checkbox",19),e.qZA(),e.TgZ(44,"div",20),e.YNc(45,P,6,11,"button",21),e.YNc(46,ee,6,11,"button",21),e.TgZ(47,"button",22),e.ALo(48,"capitalize"),e.ALo(49,"transloco"),e._uU(50),e.ALo(51,"capitalize"),e.ALo(52,"transloco"),e.qZA(),e.TgZ(53,"button",23),e.NdJ("click",function(){return r.updateUser()}),e.ALo(54,"capitalize"),e.ALo(55,"transloco"),e._uU(56),e.ALo(57,"capitalize"),e.ALo(58,"transloco"),e.qZA()()()()()()),2&t&&(e.xp6(3),e.Q6J("matTooltip","Close")("routerLink",e.DdM(69,S)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(3),e.Q6J("formGroup",r.userForm),e.xp6(3),e.Q6J("ngIf",r.user.avatar),e.xp6(1),e.Q6J("ngIf",!r.user.avatar),e.xp6(3),e.AsE(" ",r.user.name,"",r.user.phone?" - "+r.user.phone:""," "),e.xp6(2),e.hij(" @",r.user.username," "),e.xp6(1),e.Q6J("formControlName","id"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Oqu(e.lcZ(22,33,e.lcZ(23,35,"cash"))),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:currency-dollar"),e.xp6(1),e.Q6J("formControlName","cash")("placeholder",e.lcZ(26,37,e.lcZ(27,39,"cash")))("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Oqu(e.lcZ(32,41,e.lcZ(33,43,"demo cash"))),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:currency-dollar"),e.xp6(1),e.Q6J("formControlName","demoCash")("placeholder",e.lcZ(36,45,e.lcZ(37,47,"demo cash")))("spellcheck",!1),e.xp6(5),e.Oqu(e.lcZ(41,49,e.lcZ(42,51,"blocked"))),e.xp6(3),e.Q6J("checked",r.user.blocked),e.xp6(2),e.Q6J("ngIf",!r.user.blocked),e.xp6(1),e.Q6J("ngIf",r.user.blocked),e.xp6(1),e.Q6J("matTooltip",e.lcZ(48,53,e.lcZ(49,55,"cancel")))("routerLink",e.DdM(70,S)),e.xp6(3),e.hij(" ",e.lcZ(51,57,e.lcZ(52,59,"cancel"))," "),e.xp6(3),e.Q6J("color","primary")("disabled",r.userForm.invalid)("matTooltip",e.lcZ(54,61,e.lcZ(55,63,"save"))),e.xp6(3),e.hij(" ",e.lcZ(57,65,e.lcZ(58,67,"save"))," "))},dependencies:[p.O5,u.rH,T.lW,T.o6,F.oG,d.KE,d.hX,d.qo,L.Hw,k.Nt,z.gM,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,D.e,Q.Ot],encapsulation:2,changeDetection:0});class f{constructor(t){this._userService=t}resolve(t,r){return this._userService.searchUsers()}}f.\u0275fac=function(t){return new(t||f)(e.LFG(l))},f.\u0275prov=e.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"});class h{constructor(t){this._userService=t}resolve(t,r){return this._userService.getUserById(t.paramMap.get("userId"))}}h.\u0275fac=function(t){return new(t||h)(e.LFG(l))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"});class g{canDeactivate(t,r,s,i){let a=i.root;for(;a.firstChild;)a=a.firstChild;return!(i.url.includes("/management/users")&&!a.paramMap.get("userId"))||t.closeDrawer().then(()=>!0)}}g.\u0275fac=function(t){return new(t||g)},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});const te=[{path:"",component:b,children:[{path:"",component:m,resolve:{UsersResolver:f},children:[{path:":userId",canDeactivate:[g],component:Z,resolve:{UserResolver:h}}]}]},{path:"**",redirectTo:"/management/users"}];class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({imports:[u.Bz.forChild(te),u.Bz]});var re=o(42185),ne=o(9506),j=o(3238),oe=o(99602),se=o(44850),ie=o(28255),ae=o(73162),ce=o(84385),le=o(7155),ue=o(20079),pe=o(71948);class x{}x.\u0275fac=function(t){return new(t||x)},x.\u0275mod=e.oAB({type:x}),x.\u0275inj=e.cJS({providers:[{provide:j.sG,useValue:{parse:{dateInput:"D"},display:{dateInput:"DDD",monthYearLabel:"LLL yyyy",dateA11yLabel:"DD",monthYearA11yLabel:"LLLL yyyy"}}}],imports:[p.ez,v,T.ot,F.p9,oe.FA,se.t,d.lN,L.Ps,k.c,ne.En,ie.Tx,ae.Cv,pe.Fk,j.si,ce.LD,_.SJ,le.p0,z.AV,ue.V,re.m]})}}]);