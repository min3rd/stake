"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[199],{48199:(me,w,s)=>{s.r(w),s.d(w,{UserModule:()=>_});var p=s(36895),l=s(89299),e=s(94650);class x{static#e=this.\u0275fac=function(t){return new(t||x)};static#t=this.\u0275cmp=e.Xpm({type:x,selectors:[["app-user"]],decls:1,vars:0,template:function(t,r){1&t&&e._UZ(0,"router-outlet")},dependencies:[l.lC]})}var c=s(24006),I=s(77579),v=s(82722),b=s(63900),Y=s(94880),J=s(61135),L=s(95698),C=s(18505),B=s(80529),N=s(65240);class u{constructor(n,t){this._httpClient=n,this._apiService=t,this._users=new J.X([]),this._user=new J.X(null)}get users$(){return this._users.asObservable()}get user$(){return this._user.asObservable()}searchUsers(n="",t=0,r=10){return this._users.pipe((0,L.q)(1),(0,b.w)(i=>this._httpClient.get(this._apiService.admin_users(n,t,r)).pipe((0,C.b)(a=>{this._users.next(a)}))))}getUserById(n){return this._users.pipe((0,L.q)(1),(0,b.w)(t=>this._httpClient.get(this._apiService.admin_users_user(n)).pipe((0,C.b)(r=>{let i=t.findIndex(a=>a.id==r.id);i>=0?t[i]=r:t.push(r),this._users.next(t),this._user.next(r)}))))}updateUser(n){return this._users.pipe((0,L.q)(1),(0,b.w)(t=>this._httpClient.patch(this._apiService.admin_users_user(n.id),n).pipe((0,C.b)(r=>{let i=t.findIndex(a=>a.id==r.id);i>=0?t[i]=r:t.push(r),this._users.next(t),this._user.next(r)}))))}static#e=this.\u0275fac=function(t){return new(t||u)(e.LFG(B.eN),e.LFG(N.s))};static#t=this.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}var d=s(59549),U=s(97392),k=s(284),Z=s(23267),Q=s(63317),D=s(85707);const O=["matDrawer"];function M(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",24),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.name.charAt(0)," ")}}function R(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"img",25),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("src",t.avatar,e.LSH)}}function $(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.name.charAt(0)," ")}}const G=function(o,n){return{"hover:bg-gray-100 dark:hover:bg-hover":o,"bg-primary-50 dark:bg-hover":n}},H=function(o){return["./",o]};function E(o,n){if(1&o&&(e.ynx(0),e.YNc(1,M,3,1,"ng-container",13),e.TgZ(2,"a",17)(3,"div",18),e.YNc(4,R,2,1,"ng-container",13),e.YNc(5,$,3,1,"ng-container",13),e.qZA(),e.TgZ(6,"div",19)(7,"div",20)(8,"span",21),e._uU(9),e.qZA(),e.TgZ(10,"span",22),e._uU(11),e.qZA()(),e.TgZ(12,"div",23),e._uU(13),e.qZA()()(),e.BQk()),2&o){const t=n.$implicit,r=n.index,i=e.oxw(2).ngIf,a=e.oxw();e.xp6(1),e.Q6J("ngIf",0===r||t.name.charAt(0)!==i[r-1].name.charAt(0)),e.xp6(1),e.Q6J("ngClass",e.WLB(8,G,!a.selectedUser||a.selectedUser.id!==t.id,a.selectedUser&&a.selectedUser.id===t.id))("routerLink",e.VKq(11,H,t.id)),e.xp6(2),e.Q6J("ngIf",t.avatar),e.xp6(1),e.Q6J("ngIf",!t.avatar),e.xp6(4),e.hij(" ",t.name," "),e.xp6(2),e.hij(" (",t.username,") "),e.xp6(2),e.Oqu(t.phone)}}function V(o,n){if(1&o&&(e.ynx(0),e.YNc(1,E,14,13,"ng-container",16),e.BQk()),2&o){const t=e.oxw().ngIf,r=e.oxw();e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",r.trackByFn)}}function K(o,n){if(1&o&&(e.ynx(0),e.YNc(1,V,2,2,"ng-container",15),e.BQk()),2&o){const t=n.ngIf;e.oxw();const r=e.MAs(24);e.xp6(1),e.Q6J("ngIf",t.length)("ngIfElse",r)}}function W(o,n){1&o&&(e.TgZ(0,"div",27),e._uU(1),e.ALo(2,"capitalize"),e.ALo(3,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,"there are no users"))," "))}class m{constructor(n,t,r,i,a,de){this._activatedRoute=n,this._changeDetectorRef=t,this._document=r,this._router=i,this._fuseMediaWatcherService=a,this._userService=de,this.searchInputControl=new c.p4,this._unsubscribeAll=new I.x}ngOnInit(){this.users$=this._userService.users$,this._userService.user$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(n=>{this.selectedUser=n,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,v.R)(this._unsubscribeAll),(0,b.w)(n=>this._userService.searchUsers(n))).subscribe(),this.matDrawer.openedChange.subscribe(n=>{n||(this.selectedUser=null,this._changeDetectorRef.markForCheck())}),this._fuseMediaWatcherService.onMediaChange$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(({matchingAliases:n})=>{this.drawerMode=n.includes("lg")?"side":"over",this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}trackByFn(n,t){return t.id||n}static#e=this.\u0275fac=function(t){return new(t||m)(e.Y36(l.gz),e.Y36(e.sBO),e.Y36(p.K0),e.Y36(l.F0),e.Y36(Y.T),e.Y36(u))};static#t=this.\u0275cmp=e.Xpm({type:m,selectors:[["app-user-list"]],viewQuery:function(t,r){if(1&t&&e.Gf(O,7),2&t){let i;e.iGM(i=e.CRH())&&(r.matDrawer=i.first)}},decls:25,vars:20,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","md:w-160","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex-auto"],[1,"flex","flex-col","sm:flex-row","md:flex-col","flex-auto","justify-between","py-8","px-6","md:px-8","border-b"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"flex","items-center","mt-4","sm:mt-0","md:mt-4"],["subscriptSizing","dynamic",1,"fuse-mat-dense","fuse-mat-rounded","w-full","min-w-50"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"relative"],[4,"ngIf"],["noUsers",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","px-6","py-4","md:px-8","cursor-pointer","border-b",3,"ngClass","routerLink"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","ml-4"],[1,"flex","gap-2","items-center"],[1,"font-medium","leading-5","truncate"],[1,"text-secondary","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"z-10","sticky","top-0","-mt-px","px-6","py-1","md:px-8","border-t","border-b","font-medium","uppercase","text-secondary","bg-gray-50","dark:bg-gray-900"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"mat-drawer-container",1),e.NdJ("backdropClick",function(){return r.onBackdropClicked()}),e.TgZ(2,"mat-drawer",2,3),e._UZ(4,"router-outlet"),e.qZA(),e.TgZ(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),e._uU(10),e.ALo(11,"capitalize"),e.ALo(12,"transloco"),e.qZA()(),e.TgZ(13,"div",8)(14,"div",5)(15,"mat-form-field",9),e._UZ(16,"mat-icon",10)(17,"input",11),e.ALo(18,"capitalize"),e.ALo(19,"transloco"),e.qZA()()()(),e.TgZ(20,"div",12),e.YNc(21,K,2,2,"ng-container",13),e.ALo(22,"async"),e.YNc(23,W,4,5,"ng-template",null,14,e.W1O),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("mode",r.drawerMode)("opened",!1)("position","end")("disableClose",!0),e.xp6(8),e.Oqu(e.lcZ(11,10,e.lcZ(12,12,"users"))),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",r.searchInputControl)("autocomplete","off")("placeholder",e.lcZ(18,14,e.lcZ(19,16,"search users"))),e.xp6(4),e.Q6J("ngIf",e.lcZ(22,18,r.users$)))},dependencies:[p.mk,p.sg,p.O5,l.lC,l.rH,d.KE,d.qo,U.Hw,k.Nt,Z.jA,Z.kh,Z.LW,c.Fj,c.JJ,c.oH,p.Ov,Q.e,D.Ot],encapsulation:2,changeDetection:0})}var T=s(4859),F=s(56709),z=s(10266);function X(o,n){if(1&o&&e._UZ(0,"img",24),2&o){const t=e.oxw();e.Q6J("src",t.user.avatar,e.LSH)}}function q(o,n){if(1&o&&(e.TgZ(0,"div",25),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.user.name.charAt(0)," ")}}function P(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.blockUser())}),e.ALo(1,"capitalize"),e.ALo(2,"transloco"),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"transloco"),e.qZA()}2&o&&(e.Q6J("color","warn")("matTooltip",e.lcZ(1,3,e.lcZ(2,5,"block"))),e.xp6(3),e.hij(" ",e.lcZ(4,7,e.lcZ(5,9,"block"))," "))}function ee(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.unblockUser())}),e.ALo(1,"capitalize"),e.ALo(2,"transloco"),e._uU(3),e.ALo(4,"capitalize"),e.ALo(5,"transloco"),e.qZA()}2&o&&(e.Q6J("color","warn")("matTooltip",e.lcZ(1,3,e.lcZ(2,5,"unblock"))),e.xp6(3),e.hij(" ",e.lcZ(4,7,e.lcZ(5,9,"unblock"))," "))}const S=function(){return["../"]};class y{constructor(n,t,r,i){this._changeDetectorRef=n,this._userListComponent=t,this._formBuilder=r,this._userService=i,this._unsubscribeAll=new I.x}ngOnInit(){this._userListComponent.matDrawer.open(),this.userForm=this._formBuilder.group({id:[""],cash:[0],demoCash:[0],blocked:[!1]}),this._userService.user$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(n=>{this.user=n,this.userForm.patchValue(n),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDrawer(){return this._userListComponent.matDrawer.close()}trackByFn(n,t){return t.id||n}updateUser(){const n=this.userForm.getRawValue();this._userService.updateUser(n).subscribe()}blockUser(){this.user.blocked=!0,this._userService.updateUser(this.user).subscribe()}unblockUser(){this.user.blocked=!1,this._userService.updateUser(this.user).subscribe()}static#e=this.\u0275fac=function(t){return new(t||y)(e.Y36(e.sBO),e.Y36(m),e.Y36(c.QS),e.Y36(u))};static#t=this.\u0275cmp=e.Xpm({type:y,selectors:[["app-user-detail"]],decls:59,vars:71,consts:[[1,"flex","flex-col","w-full"],[1,"relative","w-full","h-40","sm:h-48","px-8","sm:px-12","bg-accent-100","dark:bg-accent-700"],[1,"flex","items-center","justify-end","w-full","max-w-3xl","mx-auto","pt-6"],["mat-icon-button","",3,"matTooltip","routerLink"],[1,"text-white",3,"svgIcon"],[1,"relative","flex","flex-col","flex-auto","items-center","px-6","sm:px-12"],[1,"w-full","max-w-3xl"],[3,"formGroup"],[1,"flex","flex-auto","-mt-16","gap-6","items-baseline"],[1,"relative","flex","items-center","justify-center","w-32","h-32","rounded-full","overflow-hidden","ring-4","ring-bg-card"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["class","flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200",4,"ngIf"],[1,"mt-8"],[1,"text-secondary"],["type","hidden",3,"formControlName"],[1,"fuse-mat-dense","fuse-mat-rounded","w-full",3,"subscriptSizing"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","type","number",3,"formControlName","placeholder","spellcheck"],[1,"mt-8","flex","flex-auto","items-center","gap-6"],["disabled","",1,"example-margin",3,"checked"],[1,"flex","items-center","mt-10","-mx-6","sm:-mx-12","py-4","pr-4","pl-1","sm:pr-12","sm:pl-7","border-t","bg-gray-50","dark:bg-transparent"],["mat-button","",3,"color","matTooltip","click",4,"ngIf"],["mat-button","",1,"ml-auto",3,"matTooltip","routerLink"],["mat-flat-button","",1,"ml-2",3,"color","disabled","matTooltip","click"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded","overflow-hidden","uppercase","text-8xl","font-bold","leading-none","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],["mat-button","",3,"color","matTooltip","click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),e._UZ(4,"mat-icon",4),e.qZA()()(),e.TgZ(5,"div",5)(6,"div",6)(7,"form",7)(8,"div",8)(9,"div",9),e.YNc(10,X,1,1,"img",10),e.YNc(11,q,2,1,"div",11),e.qZA(),e.TgZ(12,"div",12)(13,"div"),e._uU(14),e.qZA(),e.TgZ(15,"div",13),e._uU(16),e.qZA()()(),e._UZ(17,"input",14),e.TgZ(18,"div",12)(19,"mat-form-field",15)(20,"mat-label"),e._uU(21),e.ALo(22,"capitalize"),e.ALo(23,"transloco"),e.qZA(),e._UZ(24,"mat-icon",16)(25,"input",17),e.ALo(26,"capitalize"),e.ALo(27,"transloco"),e.qZA()(),e.TgZ(28,"div",12)(29,"mat-form-field",15)(30,"mat-label"),e._uU(31),e.ALo(32,"capitalize"),e.ALo(33,"transloco"),e.qZA(),e._UZ(34,"mat-icon",16)(35,"input",17),e.ALo(36,"capitalize"),e.ALo(37,"transloco"),e.qZA()(),e.TgZ(38,"div",18)(39,"mat-label"),e._uU(40),e.ALo(41,"capitalize"),e.ALo(42,"transloco"),e.qZA(),e._UZ(43,"mat-checkbox",19),e.qZA(),e.TgZ(44,"div",20),e.YNc(45,P,6,11,"button",21),e.YNc(46,ee,6,11,"button",21),e.TgZ(47,"button",22),e.ALo(48,"capitalize"),e.ALo(49,"transloco"),e._uU(50),e.ALo(51,"capitalize"),e.ALo(52,"transloco"),e.qZA(),e.TgZ(53,"button",23),e.NdJ("click",function(){return r.updateUser()}),e.ALo(54,"capitalize"),e.ALo(55,"transloco"),e._uU(56),e.ALo(57,"capitalize"),e.ALo(58,"transloco"),e.qZA()()()()()()),2&t&&(e.xp6(3),e.Q6J("matTooltip","Close")("routerLink",e.DdM(69,S)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(3),e.Q6J("formGroup",r.userForm),e.xp6(3),e.Q6J("ngIf",r.user.avatar),e.xp6(1),e.Q6J("ngIf",!r.user.avatar),e.xp6(3),e.AsE(" ",r.user.name,"",r.user.phone?" - "+r.user.phone:""," "),e.xp6(2),e.hij(" @",r.user.username," "),e.xp6(1),e.Q6J("formControlName","id"),e.xp6(2),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Oqu(e.lcZ(22,33,e.lcZ(23,35,"cash"))),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:currency-dollar"),e.xp6(1),e.Q6J("formControlName","cash")("placeholder",e.lcZ(26,37,e.lcZ(27,39,"cash")))("spellcheck",!1),e.xp6(4),e.Q6J("subscriptSizing","dynamic"),e.xp6(2),e.Oqu(e.lcZ(32,41,e.lcZ(33,43,"demo cash"))),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:currency-dollar"),e.xp6(1),e.Q6J("formControlName","demoCash")("placeholder",e.lcZ(36,45,e.lcZ(37,47,"demo cash")))("spellcheck",!1),e.xp6(5),e.Oqu(e.lcZ(41,49,e.lcZ(42,51,"blocked"))),e.xp6(3),e.Q6J("checked",r.user.blocked),e.xp6(2),e.Q6J("ngIf",!r.user.blocked),e.xp6(1),e.Q6J("ngIf",r.user.blocked),e.xp6(1),e.Q6J("matTooltip",e.lcZ(48,53,e.lcZ(49,55,"cancel")))("routerLink",e.DdM(70,S)),e.xp6(3),e.hij(" ",e.lcZ(51,57,e.lcZ(52,59,"cancel"))," "),e.xp6(3),e.Q6J("color","primary")("disabled",r.userForm.invalid)("matTooltip",e.lcZ(54,61,e.lcZ(55,63,"save"))),e.xp6(3),e.hij(" ",e.lcZ(57,65,e.lcZ(58,67,"save"))," "))},dependencies:[p.O5,l.rH,T.lW,T.o6,F.oG,d.KE,d.hX,d.qo,U.Hw,k.Nt,z.gM,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,Q.e,D.Ot],encapsulation:2,changeDetection:0})}class h{constructor(n){this._userService=n}resolve(n,t){return this._userService.searchUsers()}static#e=this.\u0275fac=function(t){return new(t||h)(e.LFG(u))};static#t=this.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}class f{constructor(n){this._userService=n}resolve(n,t){return this._userService.getUserById(n.paramMap.get("userId"))}static#e=this.\u0275fac=function(t){return new(t||f)(e.LFG(u))};static#t=this.\u0275prov=e.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"})}class g{canDeactivate(n,t,r,i){let a=i.root;for(;a.firstChild;)a=a.firstChild;return!(i.url.includes("/management/users")&&!a.paramMap.get("userId"))||n.closeDrawer().then(()=>!0)}static#e=this.\u0275fac=function(t){return new(t||g)};static#t=this.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})}const te=[{path:"",component:x,children:[{path:"",component:m,resolve:{UsersResolver:h},children:[{path:":userId",canDeactivate:[g],component:y,resolve:{UserResolver:f}}]}]},{path:"**",redirectTo:"/management/users"}];class A{static#e=this.\u0275fac=function(t){return new(t||A)};static#t=this.\u0275mod=e.oAB({type:A});static#n=this.\u0275inj=e.cJS({imports:[l.Bz.forChild(te),l.Bz]})}var ne=s(42185),re=s(9506),j=s(3238),oe=s(99602),se=s(44850),ie=s(28255),ae=s(73162),ce=s(84385),le=s(7155),ue=s(20079),pe=s(71948);class _{static#e=this.\u0275fac=function(t){return new(t||_)};static#t=this.\u0275mod=e.oAB({type:_});static#n=this.\u0275inj=e.cJS({providers:[{provide:j.sG,useValue:{parse:{dateInput:"D"},display:{dateInput:"DDD",monthYearLabel:"LLL yyyy",dateA11yLabel:"DD",monthYearA11yLabel:"LLLL yyyy"}}}],imports:[p.ez,A,T.ot,F.p9,oe.FA,se.t,d.lN,U.Ps,k.c,re.En,ie.Tx,ae.Cv,pe.Fk,j.si,ce.LD,Z.SJ,le.p0,z.AV,ue.V,ne.m]})}}}]);